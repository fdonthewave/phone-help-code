{"generator":"Code Snippets v3.9.2","date_created":"2025-11-23 19:02","snippets":[{"id":10,"name":"Qualif Pneumo Formulaire v1.0","code":"\/**\n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n * QUALIF PNEUMO - FORMULAIRE v1.0\n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n * \n * \ud83d\udccb Shortcode : [qualif_pneumo]\n * \ud83c\udfe5 Service : Dr Amiot & Dr SIMION - 02.52.69.00.33\n * \ud83d\udd2c Types RDV : \n *    - 1\u00e8re consultation pneumologie\n *    - Consultation de suivi\n *    - 1\u00e8re consultation troubles sommeil\n *    - 1\u00e8re consultation allergologie (Dr SIMION uniquement)\n * \n * \ud83d\udcbe Sauvegarde BDD : qualif_pneumo\n * \ud83d\udce7 Email auto : scripts@phone-help.com avec subject [PNEUMO - M\u00e9decins]\n * \ud83d\udd0d Zoom : 70% par d\u00e9faut (interface t\u00e9l\u00e9phonique)\n * \n * PR\u00c9REQUIS wp-config.php :\n * - define('BREVO_API_KEY', 'ta-cle');\n * - define('BREVO_SENDER_EMAIL', 'scripts@phone-help.com');\n * - define('BREVO_SENDER_NAME', 'Qualif Pneumo');\n * - define('BREVO_RECIPIENT_EMAIL', 'scripts@phone-help.com');\n * \n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n *\/\n\n\/\/ ============================================\n\/\/ CONFIGURATION CENTRALIS\u00c9E\n\/\/ ============================================\nif (!function_exists('qp_get_config')) {\n    function qp_get_config() {\n        return array(\n            'service' => 'pneumo',\n            'medecins' => 'Dr Amiot & Dr SIMION',\n            'nom_service' => 'Pneumologie',\n            'telephone' => '02.52.69.00.33',\n            'couleur_primaire' => '#0596DE',\n            'couleur_secondaire' => '#004B87',\n            'table_bdd' => 'qualif_pneumo',\n            'email_subject_prefix' => '[PNEUMO - M\u00e9decins]'\n        );\n    }\n}\n\n\/\/ ============================================\n\/\/ CR\u00c9ATION TABLE BDD AU 1ER CHARGEMENT\n\/\/ ============================================\nif (!function_exists('qp_create_table')) {\n    function qp_create_table() {\n        global $wpdb;\n        $config = qp_get_config();\n        $table = $wpdb->prefix . $config['table_bdd'];\n        $charset = $wpdb->get_charset_collate();\n        \n        $sql = \"CREATE TABLE IF NOT EXISTS $table (\n            id bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT,\n            created_at datetime NOT NULL,\n            submission_hash varchar(32) NOT NULL,\n            type_rdv varchar(100) NOT NULL,\n            medecin_affecte varchar(50) DEFAULT NULL,\n            toux varchar(3) NOT NULL,\n            crachats varchar(3) NOT NULL,\n            age int(3) NOT NULL,\n            fumeur varchar(3) NOT NULL,\n            fumeur_pa decimal(5,2) DEFAULT NULL,\n            notes_doctolib text NOT NULL,\n            email_sent tinyint(1) DEFAULT 0,\n            email_sent_at datetime DEFAULT NULL,\n            brevo_response text DEFAULT NULL,\n            ip_address varchar(45) NOT NULL,\n            user_agent varchar(255) NOT NULL,\n            PRIMARY KEY (id),\n            KEY submission_hash (submission_hash),\n            KEY created_at (created_at),\n            KEY type_rdv (type_rdv),\n            KEY email_sent (email_sent)\n        ) $charset;\";\n        \n        require_once(ABSPATH . 'wp-admin\/includes\/upgrade.php');\n        dbDelta($sql);\n        \n        error_log('\u2705 Qualif Pneumo : Table cr\u00e9\u00e9e\/v\u00e9rifi\u00e9e');\n    }\n}\n\n\/\/ Ex\u00e9cuter la cr\u00e9ation de table au chargement\nadd_action('init', 'qp_create_table');\n\n\/\/ ============================================\n\/\/ ENVOI EMAIL VIA BREVO + FALLBACK WP_MAIL\n\/\/ ============================================\nif (!function_exists('qp_send_brevo_email')) {\n    function qp_send_brevo_email($subject, $notes) {\n        $config = qp_get_config();\n        $full_subject = $config['email_subject_prefix'] . ' ' . htmlspecialchars($subject);\n        \n        \/\/ Tentative Brevo si cl\u00e9 configur\u00e9e\n        if (defined('BREVO_API_KEY') && BREVO_API_KEY !== '') {\n            $api_key = BREVO_API_KEY;\n            $sender_email = defined('BREVO_SENDER_EMAIL') ? BREVO_SENDER_EMAIL : 'noreply@phone-help.com';\n            $sender_name = defined('BREVO_SENDER_NAME') ? BREVO_SENDER_NAME : 'Qualif Pneumo';\n            $recipient_email = defined('BREVO_RECIPIENT_EMAIL') ? BREVO_RECIPIENT_EMAIL : 'scripts@phone-help.com';\n            \n            $html_content = '\n            <div style=\"font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; background: #f8f9fa;\">\n                <div style=\"background: linear-gradient(135deg, #0596DE 0%, #004B87 100%); padding: 30px; border-radius: 10px 10px 0 0;\">\n                    <h1 style=\"color: white; margin: 0; font-size: 28px; text-align: center;\">\ud83e\udec1 Qualif Pneumo<\/h1>\n                    <p style=\"color: rgba(255,255,255,0.9); margin: 10px 0 0 0; text-align: center;\">' . htmlspecialchars($config['nom_service']) . '<\/p>\n                <\/div>\n                <div style=\"background: white; padding: 30px; border-radius: 0 0 10px 10px;\">\n                    <div style=\"background: #0596DE; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center;\">\n                        <h2 style=\"margin: 0;\">' . htmlspecialchars($subject) . '<\/h2>\n                    <\/div>\n                    <pre style=\"font-family: Courier New, monospace; font-size: 14px; line-height: 1.8; background: #f8fafc; padding: 25px; border-radius: 8px; border: 2px solid #0596DE; white-space: pre-wrap; color: #1e293b;\">' . htmlspecialchars($notes) . '<\/pre>\n                <\/div>\n                <div style=\"text-align: center; padding: 20px; color: #64748b; font-size: 12px;\">\n                    <p>Email automatique - Phone-Help<\/p>\n                <\/div>\n            <\/div>';\n            \n            $response = wp_remote_post('https:\/\/api.brevo.com\/v3\/smtp\/email', array(\n                'headers' => array(\n                    'api-key' => $api_key,\n                    'Content-Type' => 'application\/json'\n                ),\n                'body' => json_encode(array(\n                    'sender' => array('email' => $sender_email, 'name' => $sender_name),\n                    'to' => array(array('email' => $recipient_email)),\n                    'subject' => $full_subject,\n                    'htmlContent' => $html_content\n                )),\n                'timeout' => 15\n            ));\n            \n            if (!is_wp_error($response)) {\n                $status = wp_remote_retrieve_response_code($response);\n                if ($status === 201) {\n                    $body = json_decode(wp_remote_retrieve_body($response), true);\n                    $message_id = isset($body['messageId']) ? $body['messageId'] : 'unknown';\n                    error_log('\u2705 Qualif Pneumo : Email Brevo envoy\u00e9 (ID: ' . $message_id . ')');\n                    return array('success' => true, 'message' => 'Email envoy\u00e9 via Brevo', 'message_id' => $message_id);\n                } else {\n                    error_log('\u26a0\ufe0f Qualif Pneumo : Brevo Status ' . $status . ' - Tentative fallback wp_mail');\n                }\n            } else {\n                error_log('\u26a0\ufe0f Qualif Pneumo : Brevo Error - ' . $response->get_error_message() . ' - Tentative fallback wp_mail');\n            }\n        }\n        \n        \/\/ FALLBACK : wp_mail si Brevo \u00e9choue ou non configur\u00e9\n        error_log('\ud83d\udce7 Qualif Pneumo : Envoi fallback via wp_mail()');\n        \n        $recipient_email = defined('BREVO_RECIPIENT_EMAIL') ? BREVO_RECIPIENT_EMAIL : get_option('admin_email');\n        $headers = array('Content-Type: text\/html; charset=UTF-8');\n        \n        $html_simple = '<html><body style=\"font-family: Arial, sans-serif;\">';\n        $html_simple .= '<h2 style=\"color: #0596DE;\">\ud83e\udec1 ' . htmlspecialchars($full_subject) . '<\/h2>';\n        $html_simple .= '<pre style=\"background: #f8fafc; padding: 20px; border: 1px solid #cbd5e1; border-radius: 5px; font-size: 13px; line-height: 1.6;\">';\n        $html_simple .= htmlspecialchars($notes);\n        $html_simple .= '<\/pre>';\n        $html_simple .= '<p style=\"color: #64748b; font-size: 12px;\">Email automatique - Qualif Pneumo (fallback wp_mail)<\/p>';\n        $html_simple .= '<\/body><\/html>';\n        \n        $wp_mail_result = wp_mail($recipient_email, $full_subject, $html_simple, $headers);\n        \n        if ($wp_mail_result) {\n            error_log('\u2705 Qualif Pneumo : Email fallback wp_mail envoy\u00e9');\n            return array('success' => true, 'message' => 'Email envoy\u00e9 via wp_mail (fallback)', 'message_id' => 'wp_mail_fallback');\n        } else {\n            error_log('\u274c Qualif Pneumo : \u00c9chec wp_mail - Aucun email envoy\u00e9');\n            return array('success' => false, 'message' => '\u00c9chec Brevo et wp_mail');\n        }\n    }\n}\n\n\/\/ ============================================\n\/\/ HANDLER AJAX - Enregistrement BDD + Email\n\/\/ ============================================\nif (!function_exists('qp_handle_submit')) {\n    function qp_handle_submit() {\n        \/\/ V\u00e9rification nonce\n        if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], 'qualif_pneumo_nonce')) {\n            wp_send_json_error(array('message' => 'S\u00e9curit\u00e9 : nonce invalide'));\n        }\n        \n        \/\/ Honeypot anti-spam\n        if (!empty($_POST['website'])) {\n            wp_send_json_error(array('message' => 'Spam d\u00e9tect\u00e9'));\n        }\n        \n        \/\/ D\u00e9codage JSON S\u00c9CURIS\u00c9\n        $json_raw = stripslashes($_POST['data']);\n        $data = json_decode($json_raw, true);\n        \n        if (!$data || json_last_error() !== JSON_ERROR_NONE) {\n            error_log('\u274c Qualif Pneumo : JSON invalide - ' . json_last_error_msg());\n            wp_send_json_error(array('message' => 'Donn\u00e9es corrompues (JSON invalide)'));\n        }\n        \n        \/\/ Validation basique\n        $required_fields = array('type_rdv', 'toux', 'crachats', 'age', 'fumeur', 'notes_doctolib');\n        foreach ($required_fields as $field) {\n            if (!isset($data[$field]) || $data[$field] === '') {\n                wp_send_json_error(array('message' => 'Champ obligatoire manquant : ' . $field));\n            }\n        }\n        \n        global $wpdb;\n        $config = qp_get_config();\n        $table = $wpdb->prefix . $config['table_bdd'];\n        \n        \/\/ Anti-doublon : Hash sur 5 minutes\n        $hash = md5(\n            $data['type_rdv'] . $data['age'] . \n            floor(time() \/ 300)\n        );\n        \n        $recent = $wpdb->get_var($wpdb->prepare(\n            \"SELECT id FROM $table WHERE submission_hash = %s LIMIT 1\",\n            $hash\n        ));\n        \n        if ($recent) {\n            wp_send_json_error(array('message' => 'Doublon d\u00e9tect\u00e9 (< 5 min)'));\n        }\n        \n        \/\/ Insertion BDD\n        $inserted = $wpdb->insert($table, array(\n            'created_at' => current_time('mysql'),\n            'submission_hash' => $hash,\n            'type_rdv' => sanitize_text_field($data['type_rdv']),\n            'medecin_affecte' => isset($data['medecin_affecte']) ? sanitize_text_field($data['medecin_affecte']) : null,\n            'toux' => sanitize_text_field($data['toux']),\n            'crachats' => sanitize_text_field($data['crachats']),\n            'age' => intval($data['age']),\n            'fumeur' => sanitize_text_field($data['fumeur']),\n            'fumeur_pa' => !empty($data['fumeur_pa']) ? floatval($data['fumeur_pa']) : null,\n            'notes_doctolib' => sanitize_textarea_field($data['notes_doctolib']),\n            'ip_address' => $_SERVER['REMOTE_ADDR'],\n            'user_agent' => substr($_SERVER['HTTP_USER_AGENT'], 0, 255)\n        ));\n        \n        if (!$inserted) {\n            error_log('\u274c Qualif Pneumo : Erreur BDD - ' . $wpdb->last_error);\n            wp_send_json_error(array('message' => 'Erreur BDD : ' . $wpdb->last_error));\n        }\n        \n        $insert_id = $wpdb->insert_id;\n        error_log('\u2705 Qualif Pneumo : Enregistrement BDD ID=' . $insert_id);\n        \n        \/\/ Envoi email\n        $email_result = qp_send_brevo_email($data['type_rdv'], $data['notes_doctolib']);\n        \n        if ($email_result['success']) {\n            $wpdb->update($table, array(\n                'email_sent' => 1,\n                'email_sent_at' => current_time('mysql'),\n                'brevo_response' => 'Message ID: ' . $email_result['message_id']\n            ), array('id' => $insert_id));\n        }\n        \n        $message = 'Qualification enregistr\u00e9e !';\n        if ($email_result['success']) {\n            $message .= ' Email envoy\u00e9 avec succ\u00e8s.';\n        } else {\n            $message .= ' (Email non envoy\u00e9 : ' . $email_result['message'] . ')';\n        }\n        \n        wp_send_json_success(array(\n            'message' => $message,\n            'id' => $insert_id,\n            'email_sent' => $email_result['success']\n        ));\n    }\n}\nadd_action('wp_ajax_qp_submit', 'qp_handle_submit');\nadd_action('wp_ajax_nopriv_qp_submit', 'qp_handle_submit');\n\n\/\/ ============================================\n\/\/ SHORTCODE PRINCIPAL\n\/\/ ============================================\nif (!function_exists('qp_shortcode')) {\n    function qp_shortcode() {\n        $config = qp_get_config();\n        $nonce = wp_create_nonce('qualif_pneumo_nonce');\n        $ajax_url = admin_url('admin-ajax.php');\n        \n        ob_start();\n        ?>\n<style>\n    * { box-sizing: border-box; }\n    .qp-wrapper { \n        max-width: 1600px; \n        margin: 20px auto; \n        padding: 20px; \n        transition: zoom 0.2s ease;\n    }\n    \n    \/* ============================================ *\/\n    \/* CONTR\u00d4LES ZOOM *\/\n    \/* ============================================ *\/\n    .qp-header {\n        background: white;\n        padding: 20px;\n        border-radius: 12px;\n        margin-bottom: 20px;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n        border-left: 5px solid <?php echo $config['couleur_primaire']; ?>;\n        position: relative;\n    }\n    \n    .qp-zoom-controls {\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        z-index: 100;\n        background: white;\n        border-radius: 12px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.2);\n        padding: 10px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        border: 3px solid <?php echo $config['couleur_primaire']; ?>;\n    }\n    \n    .qp-zoom-btn {\n        width: 45px;\n        height: 45px;\n        border: none;\n        background: linear-gradient(135deg, <?php echo $config['couleur_primaire']; ?> 0%, <?php echo $config['couleur_secondaire']; ?> 100%);\n        color: white;\n        font-size: 24px;\n        font-weight: 900;\n        border-radius: 8px;\n        cursor: pointer;\n        transition: all 0.2s;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .qp-zoom-btn:hover {\n        transform: scale(1.1);\n        box-shadow: 0 4px 12px rgba(5, 150, 222, 0.5);\n    }\n    \n    .qp-zoom-btn:active {\n        transform: scale(0.95);\n    }\n    \n    .qp-zoom-value {\n        text-align: center;\n        font-size: 13px;\n        font-weight: 800;\n        color: <?php echo $config['couleur_primaire']; ?>;\n        padding: 4px 0;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .qp-zoom-value:hover {\n        color: <?php echo $config['couleur_secondaire']; ?>;\n        text-decoration: underline;\n    }\n    \n    .qp-header-title { \n        font-size: 24px; \n        font-weight: 900; \n        color: <?php echo $config['couleur_primaire']; ?>; \n        margin: 0 0 10px 0; \n    }\n    \n    .qp-header-info { \n        font-size: 14px; \n        color: #64748b; \n        font-weight: 600; \n        margin: 0; \n    }\n    \n    \/* ============================================ *\/\n    \/* LAYOUT 2 COLONNES *\/\n    \/* ============================================ *\/\n    .qp-main-grid { \n        display: grid; \n        grid-template-columns: 1fr 1fr; \n        gap: 20px; \n        margin-bottom: 20px; \n    }\n    \n    \/* ============================================ *\/\n    \/* COLONNES *\/\n    \/* ============================================ *\/\n    .qp-section { \n        background: white; \n        padding: 20px; \n        border-radius: 12px; \n        box-shadow: 0 2px 10px rgba(0,0,0,0.08); \n        display: flex; \n        flex-direction: column;\n    }\n    \n    .qp-section-rdv { border-left: 5px solid #f59e0b; }\n    .qp-section-questions { border-left: 5px solid #10b981; }\n    \n    .qp-section-header { \n        display: flex; \n        align-items: center; \n        gap: 10px; \n        margin-bottom: 15px; \n        padding-bottom: 12px; \n        border-bottom: 3px solid #e2e8f0; \n    }\n    \n    .qp-section-icon { font-size: 28px; }\n    \n    .qp-section-title { \n        font-size: 16px; \n        font-weight: 900; \n        color: #1e293b; \n        text-transform: uppercase; \n        letter-spacing: 0.5px; \n        margin: 0; \n    }\n    \n    \/* ============================================ *\/\n    \/* QUESTIONS *\/\n    \/* ============================================ *\/\n    .qp-question { \n        background: #f8fafc; \n        padding: 12px; \n        border-radius: 8px; \n        margin-bottom: 12px; \n        border: 2px solid #e2e8f0; \n        transition: all 0.2s; \n    }\n    \n    .qp-question:hover { \n        border-color: #cbd5e1; \n        box-shadow: 0 2px 8px rgba(0,0,0,0.05); \n    }\n    \n    .qp-question-text { \n        font-size: 14px; \n        font-weight: 700; \n        color: #1e293b; \n        margin-bottom: 10px; \n    }\n    \n    .qp-label { \n        font-weight: 700; \n        font-size: 13px; \n        color: #1e293b; \n        margin-bottom: 8px;\n        display: block;\n    }\n    \n    .qp-label-required::after { \n        content: ' *'; \n        color: #dc2626; \n    }\n    \n    \/* ============================================ *\/\n    \/* RADIO BUTTONS *\/\n    \/* ============================================ *\/\n    .qp-radio-group { \n        display: flex; \n        gap: 8px; \n        flex-wrap: wrap; \n    }\n    \n    .qp-radio-group-vertical {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n    }\n    \n    .qp-radio-item { \n        flex: 1; \n        min-width: 70px; \n        display: flex; \n        align-items: center; \n        justify-content: center; \n        gap: 6px; \n        padding: 10px 16px; \n        background: white; \n        border-radius: 6px; \n        cursor: pointer; \n        transition: all 0.2s; \n        border: 2px solid #e2e8f0; \n        position: relative; \n    }\n    \n    .qp-radio-item-full {\n        flex: 1;\n        min-width: 100%;\n        justify-content: flex-start;\n        padding-left: 16px;\n    }\n    \n    .qp-radio-item:hover { \n        background: #f1f5f9; \n        border-color: #cbd5e1; \n    }\n    \n    .qp-radio-item.selected { \n        background: #dbeafe; \n        border-color: <?php echo $config['couleur_primaire']; ?>; \n        box-shadow: 0 0 0 3px rgba(5, 150, 222, 0.1); \n    }\n    \n    .qp-radio { \n        position: absolute; \n        opacity: 0; \n        width: 0; \n        height: 0; \n    }\n    \n    .qp-radio-label { \n        font-weight: 700; \n        font-size: 14px; \n        cursor: pointer; \n        color: #334155; \n        margin: 0; \n        width: 100%; \n        text-align: center; \n    }\n    \n    .qp-radio-label-left {\n        text-align: left;\n    }\n    \n    \/* ============================================ *\/\n    \/* INPUT *\/\n    \/* ============================================ *\/\n    .qp-input { \n        padding: 10px 12px; \n        border: 2px solid #cbd5e1; \n        border-radius: 6px; \n        font-size: 14px; \n        font-weight: 600; \n        color: #1e293b; \n        transition: all 0.2s; \n        width: 100%;\n    }\n    \n    .qp-input:focus { \n        outline: none; \n        border-color: <?php echo $config['couleur_primaire']; ?>; \n        box-shadow: 0 0 0 3px rgba(5, 150, 222, 0.15); \n    }\n    \n    \/* ============================================ *\/\n    \/* PANEL CONDITIONNEL *\/\n    \/* ============================================ *\/\n    .qp-panel { \n        margin-top: 10px; \n        padding: 12px; \n        background: #fef3c7; \n        border: 2px solid #f59e0b; \n        border-radius: 8px; \n        display: none; \n    }\n    \n    .qp-panel-title { \n        font-weight: 700; \n        font-size: 12px; \n        color: #92400e; \n        margin-bottom: 8px; \n    }\n    \n    .qp-pa-result {\n        background: white;\n        padding: 10px;\n        border-radius: 6px;\n        text-align: center;\n        font-size: 16px;\n        font-weight: 800;\n        color: #92400e;\n        margin-top: 10px;\n        display: none;\n    }\n    \n    \/* ============================================ *\/\n    \/* MESSAGE M\u00c9DECIN *\/\n    \/* ============================================ *\/\n    .qp-medecin-info {\n        background: #dbeafe;\n        border: 2px solid <?php echo $config['couleur_primaire']; ?>;\n        border-radius: 8px;\n        padding: 12px 16px;\n        margin-top: 10px;\n        display: none;\n    }\n    \n    .qp-medecin-text {\n        font-size: 14px;\n        font-weight: 700;\n        color: #1e40af;\n        margin: 0;\n    }\n    \n    \/* ============================================ *\/\n    \/* ACTIONS *\/\n    \/* ============================================ *\/\n    .qp-actions { \n        background: white; \n        padding: 20px; \n        border-radius: 12px; \n        box-shadow: 0 2px 10px rgba(0,0,0,0.08); \n    }\n    \n    .qp-buttons { \n        display: grid; \n        grid-template-columns: 2fr 1fr; \n        gap: 15px; \n    }\n    \n    .qp-button { \n        padding: 16px; \n        background: linear-gradient(135deg, <?php echo $config['couleur_primaire']; ?> 0%, <?php echo $config['couleur_secondaire']; ?> 100%); \n        color: white; \n        border: none; \n        border-radius: 10px; \n        font-size: 16px; \n        font-weight: 800; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n        letter-spacing: 0.5px; \n        box-shadow: 0 4px 12px rgba(5, 150, 222, 0.4); \n    }\n    \n    .qp-button:hover:not(:disabled) { \n        transform: translateY(-2px); \n        box-shadow: 0 6px 16px rgba(5, 150, 222, 0.6); \n    }\n    \n    .qp-button:disabled { \n        opacity: 0.6; \n        cursor: not-allowed; \n        transform: none; \n    }\n    \n    .qp-button-reset { \n        background: linear-gradient(135deg, #64748b 0%, #475569 100%); \n        box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4); \n    }\n    \n    .qp-button-reset:hover:not(:disabled) { \n        box-shadow: 0 6px 16px rgba(100, 116, 139, 0.6); \n    }\n    \n    \/* ============================================ *\/\n    \/* R\u00c9SULTAT *\/\n    \/* ============================================ *\/\n    .qp-result { \n        display: none; \n        position: fixed; \n        top: 0; \n        left: 0; \n        right: 0; \n        bottom: 0; \n        background: rgba(0, 0, 0, 0.95); \n        z-index: 9999; \n        overflow-y: auto; \n        animation: fadeIn 0.3s ease-out; \n    }\n    \n    @keyframes fadeIn { \n        from { opacity: 0; } \n        to { opacity: 1; } \n    }\n    \n    .qp-result-content { \n        max-width: 900px; \n        margin: 40px auto; \n        padding: 40px; \n    }\n    \n    .qp-rdv-box { \n        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); \n        padding: 50px; \n        border-radius: 20px; \n        text-align: center; \n        border: 6px solid #d97706; \n        box-shadow: 0 10px 40px rgba(251, 191, 36, 0.6); \n        margin-bottom: 30px; \n    }\n    \n    .qp-rdv-label { \n        font-size: 18px; \n        font-weight: 700; \n        color: #000; \n        text-transform: uppercase; \n        letter-spacing: 2px; \n        margin-bottom: 20px; \n    }\n    \n    .qp-rdv-value { \n        font-size: 42px; \n        font-weight: 900; \n        color: #000; \n        text-transform: uppercase; \n        text-shadow: 3px 3px 6px rgba(0,0,0,0.2); \n        line-height: 1.3; \n    }\n    \n    .qp-notes-container { \n        background: white; \n        padding: 30px; \n        border-radius: 20px; \n        box-shadow: 0 4px 20px rgba(0,0,0,0.15); \n    }\n    \n    .qp-notes-header { \n        display: flex; \n        justify-content: space-between; \n        align-items: center; \n        margin-bottom: 20px; \n        padding-bottom: 15px; \n        border-bottom: 4px solid <?php echo $config['couleur_primaire']; ?>; \n    }\n    \n    .qp-notes-title { \n        font-size: 22px; \n        font-weight: 900; \n        color: <?php echo $config['couleur_primaire']; ?>; \n        text-transform: uppercase; \n        margin: 0; \n    }\n    \n    .qp-copy-btn { \n        padding: 15px 30px; \n        background: <?php echo $config['couleur_primaire']; ?>; \n        color: white; \n        border: none; \n        border-radius: 10px; \n        font-size: 16px; \n        font-weight: 800; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n    }\n    \n    .qp-copy-btn:hover { \n        background: <?php echo $config['couleur_secondaire']; ?>; \n        transform: translateY(-3px); \n        box-shadow: 0 6px 20px rgba(5, 150, 222, 0.5); \n    }\n    \n    .qp-notes { \n        background: #f8fafc; \n        border: 3px solid #cbd5e1; \n        border-radius: 10px; \n        padding: 25px; \n        white-space: pre-wrap; \n        font-family: 'Courier New', monospace; \n        font-size: 15px; \n        line-height: 1.8; \n        color: #000; \n        font-weight: 600; \n    }\n    \n    .qp-result-actions { \n        display: flex; \n        justify-content: center; \n        gap: 20px; \n        margin-top: 30px; \n    }\n    \n    .qp-new-qualif-btn { \n        padding: 18px 40px; \n        background: linear-gradient(135deg, #10b981 0%, #059669 100%); \n        color: white; \n        border: none; \n        border-radius: 12px; \n        font-size: 18px; \n        font-weight: 900; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); \n    }\n    \n    .qp-new-qualif-btn:hover { \n        transform: translateY(-3px); \n        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6); \n    }\n    \n    \/* ============================================ *\/\n    \/* ALERT *\/\n    \/* ============================================ *\/\n    .qp-alert { \n        padding: 12px 18px; \n        border-radius: 8px; \n        margin-top: 15px; \n        font-weight: 700; \n        font-size: 14px; \n        display: none; \n    }\n    \n    .qp-alert-success { \n        background: #d1fae5; \n        color: #065f46; \n        border: 2px solid #10b981; \n    }\n    \n    .qp-alert-error { \n        background: #fee2e2; \n        color: #991b1b; \n        border: 2px solid #ef4444; \n    }\n    \n    \/* ============================================ *\/\n    \/* HONEYPOT *\/\n    \/* ============================================ *\/\n    .qp-honeypot { \n        position: absolute; \n        left: -9999px; \n        opacity: 0; \n    }\n<\/style>\n\n<div class=\"qp-wrapper\">\n    <div class=\"qp-form-container\">\n    <form id=\"qp-form\">\n        <input type=\"text\" name=\"website\" class=\"qp-honeypot\" tabindex=\"-1\" autocomplete=\"off\">\n        \n        <div class=\"qp-header\">\n            <div class=\"qp-zoom-controls\">\n                <button type=\"button\" class=\"qp-zoom-btn\" id=\"qp-zoom-plus\" title=\"Zoomer (Ctrl +)\">+<\/button>\n                <div class=\"qp-zoom-value\" id=\"qp-zoom-display\" title=\"Double-clic pour r\u00e9initialiser\">70%<\/div>\n                <button type=\"button\" class=\"qp-zoom-btn\" id=\"qp-zoom-minus\" title=\"D\u00e9zoomer (Ctrl -)\">\u2212<\/button>\n            <\/div>\n            \n            <h1 class=\"qp-header-title\">\ud83e\udec1 Qualification Pneumologie<\/h1>\n            <p class=\"qp-header-info\"><?php echo $config['medecins']; ?> - <?php echo $config['telephone']; ?><\/p>\n        <\/div>\n        \n        <div class=\"qp-main-grid\">\n            <!-- COLONNE 1 : TYPE RDV -->\n            <div class=\"qp-section qp-section-rdv\">\n                <div class=\"qp-section-header\">\n                    <span class=\"qp-section-icon\">\ud83d\udcc5<\/span>\n                    <h2 class=\"qp-section-title\">Type de RDV<\/h2>\n                <\/div>\n                \n                <div class=\"qp-question\">\n                    <label class=\"qp-label qp-label-required\">S\u00e9lectionner le type de rendez-vous<\/label>\n                    <div class=\"qp-radio-group-vertical\">\n                        <label class=\"qp-radio-item qp-radio-item-full\">\n                            <input type=\"radio\" name=\"type_rdv\" value=\"1\u00e8re consultation pneumologie\" id=\"rdv-pneumo\" class=\"qp-radio\" required>\n                            <span class=\"qp-radio-label qp-radio-label-left\">1\u00e8re consultation pneumologie<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item qp-radio-item-full\">\n                            <input type=\"radio\" name=\"type_rdv\" value=\"Consultation de suivi\" id=\"rdv-suivi\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label qp-radio-label-left\">Consultation de suivi<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item qp-radio-item-full\">\n                            <input type=\"radio\" name=\"type_rdv\" value=\"1\u00e8re consultation troubles sommeil\" id=\"rdv-sommeil\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label qp-radio-label-left\">1\u00e8re consultation troubles sommeil<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item qp-radio-item-full\">\n                            <input type=\"radio\" name=\"type_rdv\" value=\"1\u00e8re consultation allergologie\" id=\"rdv-allergo\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label qp-radio-label-left\">1\u00e8re consultation allergologie<\/span>\n                        <\/label>\n                    <\/div>\n                    \n                    <div id=\"allergo-info\" class=\"qp-medecin-info\">\n                        <p class=\"qp-medecin-text\">\ud83d\udc68\u200d\u2695\ufe0f RDV avec Dr SIMION uniquement (allergologie respiratoire)<\/p>\n                    <\/div>\n                    \n                    <div id=\"standard-info\" class=\"qp-medecin-info\">\n                        <p class=\"qp-medecin-text\">\ud83d\udc68\u200d\u2695\ufe0f RDV avec Dr Amiot ou Dr SIMION selon disponibilit\u00e9s<\/p>\n                    <\/div>\n                <\/div>\n            <\/div>\n            \n            <!-- COLONNE 2 : QUESTIONS -->\n            <div class=\"qp-section qp-section-questions\">\n                <div class=\"qp-section-header\">\n                    <span class=\"qp-section-icon\">\ud83d\udcdd<\/span>\n                    <h2 class=\"qp-section-title\">Questions<\/h2>\n                <\/div>\n                \n                <div class=\"qp-question\">\n                    <div class=\"qp-question-text\">Toux ?<\/div>\n                    <div class=\"qp-radio-group\">\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"toux\" value=\"NON\" id=\"toux-non\" class=\"qp-radio\" required>\n                            <span class=\"qp-radio-label\">NON<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"toux\" value=\"OUI\" id=\"toux-oui\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label\">OUI<\/span>\n                        <\/label>\n                    <\/div>\n                <\/div>\n                \n                <div class=\"qp-question\">\n                    <div class=\"qp-question-text\">Crachats ?<\/div>\n                    <div class=\"qp-radio-group\">\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"crachats\" value=\"NON\" id=\"crachats-non\" class=\"qp-radio\" required>\n                            <span class=\"qp-radio-label\">NON<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"crachats\" value=\"OUI\" id=\"crachats-oui\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label\">OUI<\/span>\n                        <\/label>\n                    <\/div>\n                <\/div>\n                \n                <div class=\"qp-question\">\n                    <label class=\"qp-label qp-label-required\">\u00c2ge<\/label>\n                    <input type=\"number\" name=\"age\" class=\"qp-input\" min=\"0\" max=\"120\" required placeholder=\"Ex : 45\">\n                <\/div>\n                \n                <div class=\"qp-question\">\n                    <div class=\"qp-question-text\">Fumeur actif ou arr\u00eat < 2 ans ?<\/div>\n                    <div class=\"qp-radio-group\">\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"fumeur\" value=\"NON\" id=\"fumeur-non\" class=\"qp-radio\" required>\n                            <span class=\"qp-radio-label\">NON<\/span>\n                        <\/label>\n                        <label class=\"qp-radio-item\">\n                            <input type=\"radio\" name=\"fumeur\" value=\"OUI\" id=\"fumeur-oui\" class=\"qp-radio\">\n                            <span class=\"qp-radio-label\">OUI<\/span>\n                        <\/label>\n                    <\/div>\n                    <div id=\"fumeur-panel\" class=\"qp-panel\">\n                        <div class=\"qp-panel-title\">Nombre de paquets-ann\u00e9es (PA) :<\/div>\n                        <input type=\"number\" name=\"fumeur_pa\" id=\"fumeur-pa\" class=\"qp-input\" min=\"0\" step=\"0.1\" placeholder=\"Ex : 20\">\n                        <div id=\"pa-result\" class=\"qp-pa-result\">\n                            \ud83d\udcca <span id=\"pa-value\">0<\/span> PA\n                        <\/div>\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n        \n        <div class=\"qp-actions\">\n            <div class=\"qp-buttons\">\n                <button type=\"submit\" id=\"qp-submit\" class=\"qp-button\">\n                    \ud83d\ude80 G\u00e9n\u00e9rer les notes Doctolib\n                <\/button>\n                <button type=\"button\" id=\"qp-reset\" class=\"qp-button qp-button-reset\">\n                    \ud83d\udd04 Reset\n                <\/button>\n            <\/div>\n            <div id=\"qp-alert\" class=\"qp-alert\"><\/div>\n        <\/div>\n    <\/form>\n    <\/div>\n    \n    <div id=\"qp-result\" class=\"qp-result\">\n        <div class=\"qp-result-content\">\n            <div class=\"qp-rdv-box\">\n                <div class=\"qp-rdv-label\">\u23f0 TYPE RDV DOCTOLIB<\/div>\n                <div id=\"qp-rdv-value\" class=\"qp-rdv-value\"><\/div>\n            <\/div>\n            \n            <div class=\"qp-notes-container\">\n                <div class=\"qp-notes-header\">\n                    <h3 class=\"qp-notes-title\">\ud83d\udccb Notes Doctolib<\/h3>\n                    <button type=\"button\" id=\"qp-copy\" class=\"qp-copy-btn\">\ud83d\udccb Copier<\/button>\n                <\/div>\n                <pre id=\"qp-notes\" class=\"qp-notes\"><\/pre>\n            <\/div>\n            \n            <div class=\"qp-result-actions\">\n                <button type=\"button\" id=\"qp-new-qualif\" class=\"qp-new-qualif-btn\">\n                    \ud83d\udd04 Nouvelle Qualification\n                <\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n\n<script>\n(function() {\n    'use strict';\n    const $ = jQuery;\n    const config = {\n        ajaxUrl: '<?php echo $ajax_url; ?>',\n        nonce: '<?php echo $nonce; ?>'\n    };\n    \n    const $form = $('#qp-form');\n    const $formContainer = $('.qp-form-container');\n    const $result = $('#qp-result');\n    const $notes = $('#qp-notes');\n    const $rdvValue = $('#qp-rdv-value');\n    const $alert = $('#qp-alert');\n    const $submitBtn = $('#qp-submit');\n    \n    \/\/ ============================================\n    \/\/ GESTION DU ZOOM - 70% PAR D\u00c9FAUT\n    \/\/ ============================================\n    const STORAGE_KEY = 'qualif_pneumo_zoom';\n    const minZoom = 0.5;\n    const maxZoom = 1.5;\n    const zoomStep = 0.1;\n    \n    let currentZoom;\n    let defaultZoom;\n    \n    function getDefaultZoom() {\n        return 0.7;\n    }\n    \n    function loadZoom() {\n        const saved = localStorage.getItem(STORAGE_KEY);\n        if (saved) {\n            currentZoom = parseFloat(saved);\n            console.log('\ud83d\udcca Zoom charg\u00e9 depuis localStorage:', currentZoom);\n        } else {\n            defaultZoom = getDefaultZoom();\n            currentZoom = defaultZoom;\n            console.log('\ud83d\udcca Zoom par d\u00e9faut \u00e0 70%:', currentZoom);\n        }\n        updateZoom(currentZoom, false);\n    }\n    \n    function saveZoom(zoom) {\n        localStorage.setItem(STORAGE_KEY, zoom);\n        console.log('\ud83d\udcbe Zoom sauvegard\u00e9:', zoom);\n    }\n    \n    function updateZoom(newZoom, save = true) {\n        if (newZoom < minZoom) newZoom = minZoom;\n        if (newZoom > maxZoom) newZoom = maxZoom;\n        currentZoom = newZoom;\n        $('.qp-wrapper').css('zoom', currentZoom);\n        $('#qp-zoom-display').text(Math.round(currentZoom * 100) + '%');\n        if (save) {\n            saveZoom(currentZoom);\n        }\n    }\n    \n    function resetZoom() {\n        const newDefault = getDefaultZoom();\n        updateZoom(newDefault);\n        console.log('\ud83d\udd04 Zoom r\u00e9initialis\u00e9 \u00e0 70%');\n    }\n    \n    $('#qp-zoom-plus').on('click', function() {\n        updateZoom(currentZoom + zoomStep);\n    });\n    \n    $('#qp-zoom-minus').on('click', function() {\n        updateZoom(currentZoom - zoomStep);\n    });\n    \n    $('#qp-zoom-display').on('dblclick', function() {\n        resetZoom();\n    });\n    \n    $(document).on('keydown', function(e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (e.key === '+' || e.key === '=') {\n                e.preventDefault();\n                updateZoom(currentZoom + zoomStep);\n            } else if (e.key === '-' || e.key === '_') {\n                e.preventDefault();\n                updateZoom(currentZoom - zoomStep);\n            }\n        }\n    });\n    \n    loadZoom();\n    \n    \/\/ ============================================\n    \/\/ INTERACTIONS FORMULAIRE\n    \/\/ ============================================\n    \n    \/\/ Affichage info m\u00e9decin selon type RDV\n    $('input[name=\"type_rdv\"]').on('change', function() {\n        const val = $(this).val();\n        $('#allergo-info, #standard-info').hide();\n        \n        if (val === '1\u00e8re consultation allergologie') {\n            $('#allergo-info').slideDown(200);\n        } else {\n            $('#standard-info').slideDown(200);\n        }\n    });\n    \n    \/\/ Panel fumeur\n    $('#fumeur-oui').on('change', function() { \n        $('#fumeur-panel').slideDown(200); \n    });\n    \n    $('#fumeur-non').on('change', function() { \n        $('#fumeur-panel').slideUp(200);\n        $('#fumeur-pa').val('');\n        $('#pa-result').hide();\n    });\n    \n    \/\/ Affichage PA\n    $('#fumeur-pa').on('input', function() {\n        const pa = parseFloat($(this).val()) || 0;\n        if (pa > 0) {\n            $('#pa-value').text(pa);\n            $('#pa-result').slideDown(200);\n        } else {\n            $('#pa-result').slideUp(200);\n        }\n    });\n    \n    \/\/ Style radio buttons\n    $('input[type=\"radio\"]').on('change', function() {\n        const name = $(this).attr('name');\n        $('input[name=\"' + name + '\"]').closest('.qp-radio-item').removeClass('selected');\n        $(this).closest('.qp-radio-item').addClass('selected');\n    });\n    \n    $('input[type=\"radio\"]:checked').each(function() {\n        $(this).closest('.qp-radio-item').addClass('selected');\n    });\n    \n    const utils = {\n        showAlert: function(msg, type) {\n            $alert.removeClass('qp-alert-success qp-alert-error').addClass('qp-alert-' + type).text(msg).fadeIn();\n            setTimeout(() => $alert.fadeOut(), 5000);\n        }\n    };\n    \n    \/\/ ============================================\n    \/\/ G\u00c9N\u00c9RATION NOTES DOCTOLIB\n    \/\/ ============================================\n    function generateNotes(data) {\n        let notes = '';\n        \n        notes += 'TYPE RDV : ' + data.type_rdv + '\\n';\n        if (data.medecin_affecte) {\n            notes += 'M\u00e9decin : ' + data.medecin_affecte + '\\n';\n        }\n        notes += '\\n';\n        \n        notes += 'QUESTIONS :\\n';\n        notes += 'Toux : ' + data.toux + '\\n';\n        notes += 'Crachats : ' + data.crachats + '\\n';\n        notes += '\u00c2ge : ' + data.age + ' ans\\n';\n        notes += 'Fumeur actif ou arr\u00eat < 2 ans : ' + data.fumeur;\n        if (data.fumeur === 'OUI' && data.fumeur_pa) {\n            notes += ' (' + data.fumeur_pa + ' PA)';\n        }\n        notes += '\\n';\n        \n        return notes;\n    }\n    \n    \/\/ ============================================\n    \/\/ SOUMISSION FORMULAIRE\n    \/\/ ============================================\n    $form.on('submit', function(e) {\n        e.preventDefault();\n        if ($form.data('submitting')) return false;\n        $form.data('submitting', true);\n        \n        if (!this.checkValidity()) {\n            utils.showAlert('\u26a0\ufe0f Veuillez remplir tous les champs obligatoires', 'error');\n            $form.data('submitting', false);\n            return;\n        }\n        \n        $submitBtn.prop('disabled', true).text('\u23f3 G\u00e9n\u00e9ration en cours...');\n        \n        \/\/ Collecte donn\u00e9es\n        const formData = {\n            type_rdv: $('input[name=\"type_rdv\"]:checked').val(),\n            medecin_affecte: null,\n            toux: $('input[name=\"toux\"]:checked').val(),\n            crachats: $('input[name=\"crachats\"]:checked').val(),\n            age: $('input[name=\"age\"]').val(),\n            fumeur: $('input[name=\"fumeur\"]:checked').val(),\n            fumeur_pa: null\n        };\n        \n        \/\/ M\u00e9decin affect\u00e9\n        if (formData.type_rdv === '1\u00e8re consultation allergologie') {\n            formData.medecin_affecte = 'Dr SIMION';\n        } else {\n            formData.medecin_affecte = 'Dr Amiot ou Dr SIMION';\n        }\n        \n        \/\/ PA fumeur\n        if (formData.fumeur === 'OUI') {\n            const pa = parseFloat($('#fumeur-pa').val()) || 0;\n            if (pa > 0) {\n                formData.fumeur_pa = pa;\n            }\n        }\n        \n        \/\/ G\u00e9n\u00e9ration notes\n        const notesDoctolib = generateNotes(formData);\n        \n        \/\/ Affichage r\u00e9sultat\n        $rdvValue.text(formData.type_rdv);\n        $notes.text(notesDoctolib);\n        \n        $formContainer.fadeOut(300, function() {\n            $result.fadeIn(400);\n            $('body').css('overflow', 'hidden');\n        });\n        \n        \/\/ Envoi AJAX\n        $.ajax({\n            url: config.ajaxUrl,\n            type: 'POST',\n            data: {\n                action: 'qp_submit',\n                nonce: config.nonce,\n                website: $('input[name=\"website\"]').val(),\n                data: JSON.stringify({\n                    type_rdv: formData.type_rdv,\n                    medecin_affecte: formData.medecin_affecte,\n                    toux: formData.toux,\n                    crachats: formData.crachats,\n                    age: formData.age,\n                    fumeur: formData.fumeur,\n                    fumeur_pa: formData.fumeur_pa,\n                    notes_doctolib: notesDoctolib\n                })\n            },\n            success: function(response) {\n                if (response.success) {\n                    utils.showAlert('\u2705 ' + response.data.message, 'success');\n                } else {\n                    utils.showAlert('\u26a0\ufe0f ' + response.data.message, 'error');\n                }\n            },\n            error: function() {\n                utils.showAlert('\u26a0\ufe0f Erreur r\u00e9seau (notes affich\u00e9es)', 'error');\n            },\n            complete: function() {\n                $submitBtn.prop('disabled', false).text('\ud83d\ude80 G\u00e9n\u00e9rer les notes Doctolib');\n                $form.data('submitting', false);\n            }\n        });\n    });\n    \n    \/\/ ============================================\n    \/\/ BOUTONS RESET \/ NOUVELLE QUALIF \/ COPIE\n    \/\/ ============================================\n    $('#qp-reset').on('click', function() {\n        if (confirm('R\u00e9initialiser le formulaire ?')) {\n            $form[0].reset();\n            $result.fadeOut();\n            $formContainer.fadeIn();\n            $alert.hide();\n            $('#fumeur-panel, #allergo-info, #standard-info').hide();\n            $('#pa-result').hide();\n            $('.qp-radio-item').removeClass('selected');\n            $('body').css('overflow', '');\n            $('html, body').animate({ scrollTop: 0 }, 500);\n            utils.showAlert('\u2705 Pr\u00eat pour nouvelle qualification', 'success');\n        }\n    });\n    \n    $('#qp-new-qualif').on('click', function() {\n        $result.fadeOut(300, function() {\n            $form[0].reset();\n            $('#fumeur-panel, #allergo-info, #standard-info').hide();\n            $('#pa-result').hide();\n            $('.qp-radio-item').removeClass('selected');\n            $alert.hide();\n            $formContainer.fadeIn(400);\n            $('body').css('overflow', '');\n            $('html, body').animate({ scrollTop: 0 }, 500);\n        });\n    });\n    \n    $('#qp-copy').on('click', function() {\n        const text = $notes.text();\n        if (navigator.clipboard) {\n            navigator.clipboard.writeText(text).then(function() {\n                $('#qp-copy').text('\u2713 Copi\u00e9 !');\n                setTimeout(function() { $('#qp-copy').text('\ud83d\udccb Copier'); }, 2500);\n            });\n        } else {\n            alert('Copie automatique non support\u00e9e');\n        }\n    });\n})();\n<\/script>\n        <?php\n        return ob_get_clean();\n    }\n}\n\nadd_shortcode('qualif_pneumo', 'qp_shortcode');","tags":["formulaire","qualif-pneumo"],"active":true,"modified":"2025-11-10 21:17:20","revision":"1"}]}