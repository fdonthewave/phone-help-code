{"generator":"Code Snippets v3.9.2","date_created":"2025-11-23 19:02","snippets":[{"id":12,"name":"Qualif Pneumo - DEMANDES ORDONNANCES\/CERTIFICATS v1.0","code":"\/**\n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n * QUALIF PNEUMO ORDONNANCES - FORMULAIRE v1.3\n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n * \n * \ud83d\udccb Shortcode : [qualif_pneumo_ordonnances]\n * \ud83e\udd7c Service : Dr Amiot & Dr SIMION - 02.52.69.00.33\n * \ud83d\udcec Types demandes : \n *    - Ordonnance - Renouvellement\n *    - Ordonnance - Arr\u00eat de travail\n *    - Certificat m\u00e9dical\n *    - URGENCE (v\u00e9rifier pr\u00e9sence m\u00e9decin)\n *    - Autres\n * \n * \ud83d\udcbe Sauvegarde BDD : qualif_pneumo_ordonnances\n * \ud83d\udce7 Email direct : vers m\u00e9decins (pas scripts@)\n * \ud83d\udd10 URL obscure : \/pn20256\n * \ud83d\udd0d Zoom : 70% par d\u00e9faut\n * \n * NOUVEAUT\u00c9S v1.3 :\n * \u26a1 5 types de demandes (au lieu de 2)\n * \u26a1 Option URGENCE avec message secr\u00e9taire\n * \u26a1 Banner rouge \ud83d\udea8 si URGENCE dans email\n * \u26a1 Encadrement sp\u00e9cial si URGENCE dans notes\n * \n * PR\u00c9REQUIS wp-config.php :\n * - define('BREVO_API_KEY', 'ta-cle');\n * - define('BREVO_SENDER_EMAIL', 'scripts@phone-help.com');\n * - define('BREVO_SENDER_NAME', 'Qualif Pneumo Ordonnances');\n * - define('PNEUMO_DR_AMIOT_EMAIL', 'email-dr-amiot');\n * - define('PNEUMO_DR_SIMION_EMAIL', 'email-dr-simion');\n * \n * \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n *\/\n\n\/\/ ============================================\n\/\/ CONFIGURATION CENTRALIS\u00c9E\n\/\/ ============================================\nif (!function_exists('qpo_get_config')) {\n    function qpo_get_config() {\n        return array(\n            'service' => 'pneumo-ordonnances',\n            'medecins' => 'Dr Amiot & Dr SIMION',\n            'nom_service' => 'Pneumologie - Ordonnances',\n            'telephone' => '02.52.69.00.33',\n            'couleur_primaire' => '#0596DE',\n            'couleur_secondaire' => '#004B87',\n            'couleur_urgence' => '#dc2626',\n            'table_bdd' => 'qualif_pneumo_ordonnances'\n        );\n    }\n}\n\n\/\/ ============================================\n\/\/ CR\u00c9ATION TABLE BDD AU 1ER CHARGEMENT\n\/\/ ============================================\nif (!function_exists('qpo_create_table')) {\n    function qpo_create_table() {\n        global $wpdb;\n        $config = qpo_get_config();\n        $table = $wpdb->prefix . $config['table_bdd'];\n        $charset = $wpdb->get_charset_collate();\n        \n        $sql = \"CREATE TABLE IF NOT EXISTS $table (\n            id bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT,\n            created_at datetime NOT NULL,\n            submission_hash varchar(32) NOT NULL,\n            medecin varchar(50) NOT NULL,\n            type_demande varchar(100) NOT NULL,\n            motif_demande text NOT NULL,\n            notes_doctolib text NOT NULL,\n            email_sent tinyint(1) DEFAULT 0,\n            email_sent_at datetime DEFAULT NULL,\n            brevo_response text DEFAULT NULL,\n            ip_address varchar(45) NOT NULL,\n            user_agent varchar(255) NOT NULL,\n            PRIMARY KEY (id),\n            KEY submission_hash (submission_hash),\n            KEY created_at (created_at),\n            KEY medecin (medecin),\n            KEY type_demande (type_demande),\n            KEY email_sent (email_sent)\n        ) $charset;\";\n        \n        require_once(ABSPATH . 'wp-admin\/includes\/upgrade.php');\n        dbDelta($sql);\n        \n        error_log('\u2705 Qualif Pneumo Ordonnances : Table cr\u00e9\u00e9e\/v\u00e9rifi\u00e9e');\n    }\n}\n\n\/\/ Ex\u00e9cuter la cr\u00e9ation de table au chargement\nadd_action('init', 'qpo_create_table');\n\n\/\/ ============================================\n\/\/ ENVOI EMAIL VIA BREVO + FALLBACK WP_MAIL\n\/\/ ============================================\nif (!function_exists('qpo_send_brevo_email')) {\n    function qpo_send_brevo_email($medecin, $type, $notes) {\n        $config = qpo_get_config();\n        \n        \/\/ D\u00e9terminer email destinataire\n        $recipient_email = '';\n        $medecin_nom = '';\n        \n        if ($medecin === 'Dr Amiot') {\n            $recipient_email = defined('PNEUMO_DR_AMIOT_EMAIL') ? PNEUMO_DR_AMIOT_EMAIL : '';\n            $medecin_nom = 'Dr Amiot';\n        } else {\n            $recipient_email = defined('PNEUMO_DR_SIMION_EMAIL') ? PNEUMO_DR_SIMION_EMAIL : '';\n            $medecin_nom = 'Dr SIMION';\n        }\n        \n        if (empty($recipient_email)) {\n            error_log('\u274c Qualif Pneumo Ordonnances : Email m\u00e9decin non configur\u00e9');\n            return array('success' => false, 'message' => 'Email m\u00e9decin non configur\u00e9');\n        }\n        \n        \/\/ D\u00e9tection URGENCE\n        $is_urgence = (strpos($type, 'URGENCE') !== false);\n        \n        \/\/ Subject avec pr\u00e9fixe URGENCE si n\u00e9cessaire\n        $subject_prefix = $is_urgence ? '\ud83d\udea8 URGENCE - ' : '';\n        $full_subject = $subject_prefix . '[PNEUMO - Ordonnances] ' . htmlspecialchars($type);\n        \n        \/\/ Banner urgence si applicable\n        $urgence_banner = '';\n        if ($is_urgence) {\n            $urgence_banner = '\n            <div style=\"background: #dc2626; color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; text-align: center; border: 4px solid #991b1b;\">\n                <h2 style=\"margin: 0; font-size: 24px; font-weight: 900;\">\ud83d\udea8 URGENCE - TRAITEMENT PRIORITAIRE \ud83d\udea8<\/h2>\n                <p style=\"margin: 10px 0 0 0; font-size: 16px;\">Patient au cabinet ou \u00e0 proximit\u00e9<\/p>\n            <\/div>';\n        }\n        \n        \/\/ Tentative Brevo si cl\u00e9 configur\u00e9e\n        if (defined('BREVO_API_KEY') && BREVO_API_KEY !== '') {\n            $api_key = BREVO_API_KEY;\n            $sender_email = defined('BREVO_SENDER_EMAIL') ? BREVO_SENDER_EMAIL : 'noreply@phone-help.com';\n            $sender_name = defined('BREVO_SENDER_NAME') ? BREVO_SENDER_NAME : 'Qualif Pneumo Ordonnances';\n            \n            $html_content = '\n            <div style=\"font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; background: #f8f9fa;\">\n                <div style=\"background: linear-gradient(135deg, #0596DE 0%, #004B87 100%); padding: 30px; border-radius: 10px 10px 0 0;\">\n                    <h1 style=\"color: white; margin: 0; font-size: 28px; text-align: center;\">\ud83e\udec1 ' . htmlspecialchars($type) . '<\/h1>\n                    <p style=\"color: rgba(255,255,255,0.9); margin: 10px 0 0 0; text-align: center;\">Destinataire : ' . htmlspecialchars($medecin_nom) . '<\/p>\n                <\/div>\n                <div style=\"background: white; padding: 30px; border-radius: 0 0 10px 10px;\">\n                    ' . $urgence_banner . '\n                    <pre style=\"font-family: Courier New, monospace; font-size: 14px; line-height: 1.8; background: #f8fafc; padding: 25px; border-radius: 8px; border: 2px solid ' . ($is_urgence ? '#dc2626' : '#0596DE') . '; white-space: pre-wrap; color: #1e293b;\">' . htmlspecialchars($notes) . '<\/pre>\n                <\/div>\n                <div style=\"text-align: center; padding: 20px; color: #64748b; font-size: 12px;\">\n                    <p>Email automatique - Phone-Help<\/p>\n                <\/div>\n            <\/div>';\n            \n            $response = wp_remote_post('https:\/\/api.brevo.com\/v3\/smtp\/email', array(\n                'headers' => array(\n                    'api-key' => $api_key,\n                    'Content-Type' => 'application\/json'\n                ),\n                'body' => json_encode(array(\n                    'sender' => array('email' => $sender_email, 'name' => $sender_name),\n                    'to' => array(array('email' => $recipient_email)),\n                    'subject' => $full_subject,\n                    'htmlContent' => $html_content\n                )),\n                'timeout' => 15\n            ));\n            \n            if (!is_wp_error($response)) {\n                $status = wp_remote_retrieve_response_code($response);\n                if ($status === 201) {\n                    $body = json_decode(wp_remote_retrieve_body($response), true);\n                    $message_id = isset($body['messageId']) ? $body['messageId'] : 'unknown';\n                    error_log('\u2705 Qualif Pneumo Ordonnances : Email Brevo envoy\u00e9 (ID: ' . $message_id . ')');\n                    return array('success' => true, 'message' => 'Email envoy\u00e9 via Brevo', 'message_id' => $message_id);\n                } else {\n                    error_log('\u26a0\ufe0f Qualif Pneumo Ordonnances : Brevo Status ' . $status . ' - Tentative fallback wp_mail');\n                }\n            } else {\n                error_log('\u26a0\ufe0f Qualif Pneumo Ordonnances : Brevo Error - ' . $response->get_error_message() . ' - Tentative fallback wp_mail');\n            }\n        }\n        \n        \/\/ FALLBACK : wp_mail si Brevo \u00e9choue ou non configur\u00e9\n        error_log('\ud83d\udce7 Qualif Pneumo Ordonnances : Envoi fallback via wp_mail()');\n        \n        $headers = array('Content-Type: text\/html; charset=UTF-8');\n        \n        $html_simple = '<html><body style=\"font-family: Arial, sans-serif;\">';\n        if ($is_urgence) {\n            $html_simple .= '<div style=\"background: #dc2626; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center;\">';\n            $html_simple .= '<h2 style=\"margin: 0;\">\ud83d\udea8 URGENCE - TRAITEMENT PRIORITAIRE \ud83d\udea8<\/h2>';\n            $html_simple .= '<p style=\"margin: 5px 0 0 0;\">Patient au cabinet ou \u00e0 proximit\u00e9<\/p>';\n            $html_simple .= '<\/div>';\n        }\n        $html_simple .= '<h2 style=\"color: #0596DE;\">\ud83e\udec1 ' . htmlspecialchars($full_subject) . '<\/h2>';\n        $html_simple .= '<p><strong>Destinataire :<\/strong> ' . htmlspecialchars($medecin_nom) . '<\/p>';\n        $html_simple .= '<pre style=\"background: #f8fafc; padding: 20px; border: 1px solid ' . ($is_urgence ? '#dc2626' : '#cbd5e1') . '; border-radius: 5px; font-size: 13px; line-height: 1.6;\">';\n        $html_simple .= htmlspecialchars($notes);\n        $html_simple .= '<\/pre>';\n        $html_simple .= '<p style=\"color: #64748b; font-size: 12px;\">Email automatique - Qualif Pneumo Ordonnances (fallback wp_mail)<\/p>';\n        $html_simple .= '<\/body><\/html>';\n        \n        $wp_mail_result = wp_mail($recipient_email, $full_subject, $html_simple, $headers);\n        \n        if ($wp_mail_result) {\n            error_log('\u2705 Qualif Pneumo Ordonnances : Email fallback wp_mail envoy\u00e9');\n            return array('success' => true, 'message' => 'Email envoy\u00e9 via wp_mail (fallback)', 'message_id' => 'wp_mail_fallback');\n        } else {\n            error_log('\u274c Qualif Pneumo Ordonnances : \u00c9chec wp_mail - Aucun email envoy\u00e9');\n            return array('success' => false, 'message' => '\u00c9chec Brevo et wp_mail');\n        }\n    }\n}\n\n\/\/ ============================================\n\/\/ HANDLER AJAX - Enregistrement BDD + Email\n\/\/ ============================================\nif (!function_exists('qpo_handle_submit')) {\n    function qpo_handle_submit() {\n        \/\/ V\u00e9rification nonce\n        if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], 'qualif_pneumo_ordonnances_nonce')) {\n            wp_send_json_error(array('message' => 'S\u00e9curit\u00e9 : nonce invalide'));\n        }\n        \n        \/\/ Honeypot anti-spam\n        if (!empty($_POST['website'])) {\n            wp_send_json_error(array('message' => 'Spam d\u00e9tect\u00e9'));\n        }\n        \n        \/\/ D\u00e9codage JSON S\u00c9CURIS\u00c9\n        $json_raw = stripslashes($_POST['data']);\n        $data = json_decode($json_raw, true);\n        \n        if (!$data || json_last_error() !== JSON_ERROR_NONE) {\n            error_log('\u274c Qualif Pneumo Ordonnances : JSON invalide - ' . json_last_error_msg());\n            wp_send_json_error(array('message' => 'Donn\u00e9es corrompues (JSON invalide)'));\n        }\n        \n        \/\/ Validation basique\n        $required_fields = array('medecin', 'type_demande', 'motif_demande', 'notes_doctolib');\n        foreach ($required_fields as $field) {\n            if (!isset($data[$field]) || $data[$field] === '') {\n                wp_send_json_error(array('message' => 'Champ obligatoire manquant : ' . $field));\n            }\n        }\n        \n        global $wpdb;\n        $config = qpo_get_config();\n        $table = $wpdb->prefix . $config['table_bdd'];\n        \n        \/\/ Anti-doublon : Hash sur 5 minutes\n        $hash = md5(\n            $data['medecin'] . $data['type_demande'] . \n            floor(time() \/ 300)\n        );\n        \n        $recent = $wpdb->get_var($wpdb->prepare(\n            \"SELECT id FROM $table WHERE submission_hash = %s LIMIT 1\",\n            $hash\n        ));\n        \n        if ($recent) {\n            wp_send_json_error(array('message' => 'Doublon d\u00e9tect\u00e9 (< 5 min)'));\n        }\n        \n        \/\/ Insertion BDD\n        $inserted = $wpdb->insert($table, array(\n            'created_at' => current_time('mysql'),\n            'submission_hash' => $hash,\n            'medecin' => sanitize_text_field($data['medecin']),\n            'type_demande' => sanitize_text_field($data['type_demande']),\n            'motif_demande' => sanitize_textarea_field($data['motif_demande']),\n            'notes_doctolib' => sanitize_textarea_field($data['notes_doctolib']),\n            'ip_address' => $_SERVER['REMOTE_ADDR'],\n            'user_agent' => substr($_SERVER['HTTP_USER_AGENT'], 0, 255)\n        ));\n        \n        if (!$inserted) {\n            error_log('\u274c Qualif Pneumo Ordonnances : Erreur BDD - ' . $wpdb->last_error);\n            wp_send_json_error(array('message' => 'Erreur BDD : ' . $wpdb->last_error));\n        }\n        \n        $insert_id = $wpdb->insert_id;\n        error_log('\u2705 Qualif Pneumo Ordonnances : Enregistrement BDD ID=' . $insert_id);\n        \n        \/\/ Envoi email direct au m\u00e9decin\n        $email_result = qpo_send_brevo_email($data['medecin'], $data['type_demande'], $data['notes_doctolib']);\n        \n        if ($email_result['success']) {\n            $wpdb->update($table, array(\n                'email_sent' => 1,\n                'email_sent_at' => current_time('mysql'),\n                'brevo_response' => 'Message ID: ' . $email_result['message_id']\n            ), array('id' => $insert_id));\n        }\n        \n        $message = 'Demande enregistr\u00e9e !';\n        if ($email_result['success']) {\n            $message .= ' Email envoy\u00e9 avec succ\u00e8s.';\n        } else {\n            $message .= ' (Email non envoy\u00e9 : ' . $email_result['message'] . ')';\n        }\n        \n        wp_send_json_success(array(\n            'message' => $message,\n            'id' => $insert_id,\n            'email_sent' => $email_result['success']\n        ));\n    }\n}\nadd_action('wp_ajax_qpo_submit', 'qpo_handle_submit');\nadd_action('wp_ajax_nopriv_qpo_submit', 'qpo_handle_submit');\n\n\/\/ ============================================\n\/\/ SHORTCODE PRINCIPAL\n\/\/ ============================================\nif (!function_exists('qpo_shortcode')) {\n    function qpo_shortcode() {\n        $config = qpo_get_config();\n        $nonce = wp_create_nonce('qualif_pneumo_ordonnances_nonce');\n        $ajax_url = admin_url('admin-ajax.php');\n        \n        ob_start();\n        ?>\n<style>\n    * { box-sizing: border-box; }\n    .qpo-wrapper { \n        max-width: 1200px; \n        margin: 20px auto; \n        padding: 20px; \n        transition: zoom 0.2s ease;\n    }\n    \n    \/* ============================================ *\/\n    \/* CONTR\u00d4LES ZOOM *\/\n    \/* ============================================ *\/\n    .qpo-header {\n        background: white;\n        padding: 20px;\n        border-radius: 12px;\n        margin-bottom: 20px;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n        border-left: 5px solid <?php echo $config['couleur_primaire']; ?>;\n        position: relative;\n    }\n    \n    .qpo-zoom-controls {\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        z-index: 100;\n        background: white;\n        border-radius: 12px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.2);\n        padding: 10px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        border: 3px solid <?php echo $config['couleur_primaire']; ?>;\n    }\n    \n    .qpo-zoom-btn {\n        width: 45px;\n        height: 45px;\n        border: none;\n        background: linear-gradient(135deg, <?php echo $config['couleur_primaire']; ?> 0%, <?php echo $config['couleur_secondaire']; ?> 100%);\n        color: white;\n        font-size: 24px;\n        font-weight: 900;\n        border-radius: 8px;\n        cursor: pointer;\n        transition: all 0.2s;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .qpo-zoom-btn:hover {\n        transform: scale(1.1);\n        box-shadow: 0 4px 12px rgba(5, 150, 222, 0.5);\n    }\n    \n    .qpo-zoom-btn:active {\n        transform: scale(0.95);\n    }\n    \n    .qpo-zoom-value {\n        text-align: center;\n        font-size: 13px;\n        font-weight: 800;\n        color: <?php echo $config['couleur_primaire']; ?>;\n        padding: 4px 0;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .qpo-zoom-value:hover {\n        color: <?php echo $config['couleur_secondaire']; ?>;\n        text-decoration: underline;\n    }\n    \n    .qpo-header-title { \n        font-size: 24px; \n        font-weight: 900; \n        color: <?php echo $config['couleur_primaire']; ?>; \n        margin: 0 0 10px 0; \n    }\n    \n    .qpo-header-info { \n        font-size: 14px; \n        color: #64748b; \n        font-weight: 600; \n        margin: 0; \n    }\n    \n    \/* ============================================ *\/\n    \/* SECTIONS *\/\n    \/* ============================================ *\/\n    .qpo-section { \n        background: white; \n        padding: 20px; \n        border-radius: 12px; \n        box-shadow: 0 2px 10px rgba(0,0,0,0.08); \n        margin-bottom: 20px;\n        border-left: 5px solid <?php echo $config['couleur_primaire']; ?>;\n    }\n    \n    .qpo-section-title { \n        font-size: 18px; \n        font-weight: 900; \n        color: <?php echo $config['couleur_primaire']; ?>; \n        margin: 0 0 20px 0; \n        text-transform: uppercase; \n        letter-spacing: 0.5px; \n    }\n    \n    \/* ============================================ *\/\n    \/* QUESTIONS *\/\n    \/* ============================================ *\/\n    .qpo-question { \n        margin-bottom: 20px;\n    }\n    \n    .qpo-label { \n        font-weight: 700; \n        font-size: 14px; \n        color: #1e293b; \n        margin-bottom: 10px;\n        display: block;\n    }\n    \n    .qpo-label-required::after { \n        content: ' *'; \n        color: #dc2626; \n    }\n    \n    \/* ============================================ *\/\n    \/* RADIO BUTTONS *\/\n    \/* ============================================ *\/\n    .qpo-radio-group { \n        display: flex; \n        gap: 10px; \n        flex-wrap: wrap; \n    }\n    \n    .qpo-radio-group-vertical {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n    \n    .qpo-radio-item { \n        flex: 1; \n        min-width: 150px;\n        display: flex; \n        align-items: center; \n        justify-content: center; \n        gap: 8px; \n        padding: 12px 20px; \n        background: white; \n        border-radius: 8px; \n        cursor: pointer; \n        transition: all 0.2s; \n        border: 2px solid #e2e8f0; \n        position: relative; \n    }\n    \n    .qpo-radio-item-full {\n        min-width: 100%;\n        justify-content: flex-start;\n        padding-left: 20px;\n    }\n    \n    .qpo-radio-item:hover { \n        background: #f1f5f9; \n        border-color: #cbd5e1; \n    }\n    \n    .qpo-radio-item.selected { \n        background: #dbeafe; \n        border-color: <?php echo $config['couleur_primaire']; ?>; \n        box-shadow: 0 0 0 3px rgba(5, 150, 222, 0.1); \n    }\n    \n    .qpo-radio-item.urgence {\n        border-color: <?php echo $config['couleur_urgence']; ?>;\n        background: #fee2e2;\n    }\n    \n    .qpo-radio-item.urgence.selected {\n        background: #fecaca;\n        border-color: <?php echo $config['couleur_urgence']; ?>;\n        box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2);\n    }\n    \n    .qpo-radio { \n        position: absolute; \n        opacity: 0; \n        width: 0; \n        height: 0; \n    }\n    \n    .qpo-radio-label { \n        font-weight: 700; \n        font-size: 14px; \n        cursor: pointer; \n        color: #334155; \n        margin: 0; \n        text-align: center;\n    }\n    \n    .qpo-radio-label-left {\n        text-align: left;\n        width: 100%;\n    }\n    \n    .qpo-radio-label.urgence-label {\n        color: <?php echo $config['couleur_urgence']; ?>;\n    }\n    \n    \/* ============================================ *\/\n    \/* MESSAGE URGENCE SECR\u00c9TAIRE *\/\n    \/* ============================================ *\/\n    .qpo-urgence-warning {\n        background: #fef3c7;\n        border: 3px solid #f59e0b;\n        border-radius: 8px;\n        padding: 15px;\n        margin-top: 15px;\n        display: none;\n    }\n    \n    .qpo-urgence-warning-text {\n        font-size: 14px;\n        font-weight: 700;\n        color: #92400e;\n        margin: 0;\n        display: flex;\n        align-items: center;\n        gap: 10px;\n    }\n    \n    .qpo-urgence-icon {\n        font-size: 24px;\n    }\n    \n    \/* ============================================ *\/\n    \/* TEXTAREA *\/\n    \/* ============================================ *\/\n    .qpo-textarea { \n        width: 100%;\n        padding: 12px; \n        border: 2px solid #cbd5e1; \n        border-radius: 8px; \n        font-size: 14px; \n        font-weight: 600; \n        color: #1e293b; \n        transition: all 0.2s;\n        font-family: Arial, sans-serif;\n        resize: vertical;\n        min-height: 120px;\n    }\n    \n    .qpo-textarea:focus { \n        outline: none; \n        border-color: <?php echo $config['couleur_primaire']; ?>; \n        box-shadow: 0 0 0 3px rgba(5, 150, 222, 0.15); \n    }\n    \n    \/* ============================================ *\/\n    \/* ACTIONS *\/\n    \/* ============================================ *\/\n    .qpo-actions { \n        background: white; \n        padding: 20px; \n        border-radius: 12px; \n        box-shadow: 0 2px 10px rgba(0,0,0,0.08); \n    }\n    \n    .qpo-buttons { \n        display: grid; \n        grid-template-columns: 2fr 1fr; \n        gap: 15px; \n    }\n    \n    .qpo-button { \n        padding: 16px; \n        background: linear-gradient(135deg, <?php echo $config['couleur_primaire']; ?> 0%, <?php echo $config['couleur_secondaire']; ?> 100%); \n        color: white; \n        border: none; \n        border-radius: 10px; \n        font-size: 16px; \n        font-weight: 800; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n        letter-spacing: 0.5px; \n        box-shadow: 0 4px 12px rgba(5, 150, 222, 0.4); \n    }\n    \n    .qpo-button:hover:not(:disabled) { \n        transform: translateY(-2px); \n        box-shadow: 0 6px 16px rgba(5, 150, 222, 0.6); \n    }\n    \n    .qpo-button:disabled { \n        opacity: 0.6; \n        cursor: not-allowed; \n        transform: none; \n    }\n    \n    .qpo-button-reset { \n        background: linear-gradient(135deg, #64748b 0%, #475569 100%); \n        box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4); \n    }\n    \n    .qpo-button-reset:hover:not(:disabled) { \n        box-shadow: 0 6px 16px rgba(100, 116, 139, 0.6); \n    }\n    \n    \/* ============================================ *\/\n    \/* R\u00c9SULTAT *\/\n    \/* ============================================ *\/\n    .qpo-result { \n        display: none; \n        position: fixed; \n        top: 0; \n        left: 0; \n        right: 0; \n        bottom: 0; \n        background: rgba(0, 0, 0, 0.95); \n        z-index: 9999; \n        overflow-y: auto; \n        animation: fadeIn 0.3s ease-out; \n    }\n    \n    @keyframes fadeIn { \n        from { opacity: 0; } \n        to { opacity: 1; } \n    }\n    \n    .qpo-result-content { \n        max-width: 900px; \n        margin: 40px auto; \n        padding: 40px; \n    }\n    \n    .qpo-type-box { \n        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); \n        padding: 40px; \n        border-radius: 20px; \n        text-align: center; \n        border: 6px solid #d97706; \n        box-shadow: 0 10px 40px rgba(251, 191, 36, 0.6); \n        margin-bottom: 30px; \n    }\n    \n    .qpo-type-box.urgence {\n        background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);\n        border-color: #7f1d1d;\n        box-shadow: 0 10px 40px rgba(220, 38, 38, 0.6);\n    }\n    \n    .qpo-type-label { \n        font-size: 16px; \n        font-weight: 700; \n        color: #000; \n        text-transform: uppercase; \n        letter-spacing: 2px; \n        margin-bottom: 15px; \n    }\n    \n    .qpo-type-label.urgence-label {\n        color: white;\n    }\n    \n    .qpo-type-value { \n        font-size: 32px; \n        font-weight: 900; \n        color: #000; \n        text-transform: uppercase; \n        text-shadow: 2px 2px 4px rgba(0,0,0,0.2); \n        line-height: 1.3; \n    }\n    \n    .qpo-type-value.urgence-value {\n        color: white;\n        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);\n    }\n    \n    .qpo-notes-container { \n        background: white; \n        padding: 30px; \n        border-radius: 20px; \n        box-shadow: 0 4px 20px rgba(0,0,0,0.15); \n    }\n    \n    .qpo-notes-header { \n        display: flex; \n        justify-content: space-between; \n        align-items: center; \n        margin-bottom: 20px; \n        padding-bottom: 15px; \n        border-bottom: 4px solid <?php echo $config['couleur_primaire']; ?>; \n    }\n    \n    .qpo-notes-title { \n        font-size: 22px; \n        font-weight: 900; \n        color: <?php echo $config['couleur_primaire']; ?>; \n        text-transform: uppercase; \n        margin: 0; \n    }\n    \n    .qpo-copy-btn { \n        padding: 15px 30px; \n        background: <?php echo $config['couleur_primaire']; ?>; \n        color: white; \n        border: none; \n        border-radius: 10px; \n        font-size: 16px; \n        font-weight: 800; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n    }\n    \n    .qpo-copy-btn:hover { \n        background: <?php echo $config['couleur_secondaire']; ?>; \n        transform: translateY(-3px); \n        box-shadow: 0 6px 20px rgba(5, 150, 222, 0.5); \n    }\n    \n    .qpo-notes { \n        background: #f8fafc; \n        border: 3px solid #cbd5e1; \n        border-radius: 10px; \n        padding: 25px; \n        white-space: pre-wrap; \n        font-family: 'Courier New', monospace; \n        font-size: 15px; \n        line-height: 1.8; \n        color: #000; \n        font-weight: 600; \n    }\n    \n    .qpo-result-actions { \n        display: flex; \n        justify-content: center; \n        gap: 20px; \n        margin-top: 30px; \n    }\n    \n    .qpo-new-demande-btn { \n        padding: 18px 40px; \n        background: linear-gradient(135deg, #10b981 0%, #059669 100%); \n        color: white; \n        border: none; \n        border-radius: 12px; \n        font-size: 18px; \n        font-weight: 900; \n        cursor: pointer; \n        transition: all 0.3s; \n        text-transform: uppercase; \n        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); \n    }\n    \n    .qpo-new-demande-btn:hover { \n        transform: translateY(-3px); \n        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6); \n    }\n    \n    \/* ============================================ *\/\n    \/* ALERT *\/\n    \/* ============================================ *\/\n    .qpo-alert { \n        padding: 12px 18px; \n        border-radius: 8px; \n        margin-top: 15px; \n        font-weight: 700; \n        font-size: 14px; \n        display: none; \n    }\n    \n    .qpo-alert-success { \n        background: #d1fae5; \n        color: #065f46; \n        border: 2px solid #10b981; \n    }\n    \n    .qpo-alert-error { \n        background: #fee2e2; \n        color: #991b1b; \n        border: 2px solid #ef4444; \n    }\n    \n    \/* ============================================ *\/\n    \/* HONEYPOT *\/\n    \/* ============================================ *\/\n    .qpo-honeypot { \n        position: absolute; \n        left: -9999px; \n        opacity: 0; \n    }\n<\/style>\n\n<div class=\"qpo-wrapper\">\n    <div class=\"qpo-form-container\">\n    <form id=\"qpo-form\">\n        <input type=\"text\" name=\"website\" class=\"qpo-honeypot\" tabindex=\"-1\" autocomplete=\"off\">\n        \n        <div class=\"qpo-header\">\n            <div class=\"qpo-zoom-controls\">\n                <button type=\"button\" class=\"qpo-zoom-btn\" id=\"qpo-zoom-plus\" title=\"Zoomer (Ctrl +)\">+<\/button>\n                <div class=\"qpo-zoom-value\" id=\"qpo-zoom-display\" title=\"Double-clic pour r\u00e9initialiser\">70%<\/div>\n                <button type=\"button\" class=\"qpo-zoom-btn\" id=\"qpo-zoom-minus\" title=\"D\u00e9zoomer (Ctrl -)\">\u2212<\/button>\n            <\/div>\n            \n            <h1 class=\"qpo-header-title\">\ud83e\udec1 Demande Ordonnances<\/h1>\n            <p class=\"qpo-header-info\"><?php echo $config['medecins']; ?> - <?php echo $config['telephone']; ?><\/p>\n        <\/div>\n        \n        <!-- SECTION M\u00c9DECIN -->\n        <div class=\"qpo-section\">\n            <h2 class=\"qpo-section-title\">\ud83d\udc68\u200d\u2695\ufe0f M\u00e9decin destinataire<\/h2>\n            \n            <div class=\"qpo-question\">\n                <label class=\"qpo-label qpo-label-required\">S\u00e9lectionner le m\u00e9decin<\/label>\n                <div class=\"qpo-radio-group\">\n                    <label class=\"qpo-radio-item\">\n                        <input type=\"radio\" name=\"medecin\" value=\"Dr Amiot\" id=\"medecin-amiot\" class=\"qpo-radio\" required>\n                        <span class=\"qpo-radio-label\">Dr Amiot<\/span>\n                    <\/label>\n                    <label class=\"qpo-radio-item\">\n                        <input type=\"radio\" name=\"medecin\" value=\"Dr SIMION\" id=\"medecin-simion\" class=\"qpo-radio\">\n                        <span class=\"qpo-radio-label\">Dr SIMION<\/span>\n                    <\/label>\n                <\/div>\n            <\/div>\n        <\/div>\n        \n        <!-- SECTION TYPE DEMANDE -->\n        <div class=\"qpo-section\">\n            <h2 class=\"qpo-section-title\">\ud83d\udccb Type de demande<\/h2>\n            \n            <div class=\"qpo-question\">\n                <label class=\"qpo-label qpo-label-required\">S\u00e9lectionner le type<\/label>\n                <div class=\"qpo-radio-group-vertical\">\n                    <label class=\"qpo-radio-item qpo-radio-item-full\">\n                        <input type=\"radio\" name=\"type_demande\" value=\"Ordonnance - Renouvellement\" id=\"type-renouvellement\" class=\"qpo-radio\" required>\n                        <span class=\"qpo-radio-label qpo-radio-label-left\">Ordonnance - Renouvellement<\/span>\n                    <\/label>\n                    <label class=\"qpo-radio-item qpo-radio-item-full\">\n                        <input type=\"radio\" name=\"type_demande\" value=\"Ordonnance - Arr\u00eat de travail\" id=\"type-arret\" class=\"qpo-radio\">\n                        <span class=\"qpo-radio-label qpo-radio-label-left\">Ordonnance - Arr\u00eat de travail<\/span>\n                    <\/label>\n                    <label class=\"qpo-radio-item qpo-radio-item-full\">\n                        <input type=\"radio\" name=\"type_demande\" value=\"Certificat m\u00e9dical\" id=\"type-certificat\" class=\"qpo-radio\">\n                        <span class=\"qpo-radio-label qpo-radio-label-left\">Certificat m\u00e9dical<\/span>\n                    <\/label>\n                    <label class=\"qpo-radio-item qpo-radio-item-full urgence\">\n                        <input type=\"radio\" name=\"type_demande\" value=\"URGENCE\" id=\"type-urgence\" class=\"qpo-radio\">\n                        <span class=\"qpo-radio-label qpo-radio-label-left urgence-label\">\ud83d\udea8 URGENCE<\/span>\n                    <\/label>\n                    <label class=\"qpo-radio-item qpo-radio-item-full\">\n                        <input type=\"radio\" name=\"type_demande\" value=\"Autres\" id=\"type-autres\" class=\"qpo-radio\">\n                        <span class=\"qpo-radio-label qpo-radio-label-left\">Autres<\/span>\n                    <\/label>\n                <\/div>\n                \n                <!-- MESSAGE URGENCE POUR SECR\u00c9TAIRES -->\n                <div id=\"urgence-warning\" class=\"qpo-urgence-warning\">\n                    <p class=\"qpo-urgence-warning-text\">\n                        <span class=\"qpo-urgence-icon\">\u26a0\ufe0f<\/span>\n                        <span>V\u00e9rifier la pr\u00e9sence du m\u00e9decin au cabinet avant d'envoyer<\/span>\n                    <\/p>\n                <\/div>\n            <\/div>\n        <\/div>\n        \n        <!-- SECTION MOTIF -->\n        <div class=\"qpo-section\">\n            <h2 class=\"qpo-section-title\">\ud83d\udcac Motif de la demande<\/h2>\n            \n            <div class=\"qpo-question\">\n                <label class=\"qpo-label qpo-label-required\">Pr\u00e9ciser le motif<\/label>\n                <textarea name=\"motif_demande\" class=\"qpo-textarea\" required placeholder=\"Ex : Patient demande renouvellement traitement Symbicort + Ventoline...\"><\/textarea>\n            <\/div>\n        <\/div>\n        \n        <div class=\"qpo-actions\">\n            <div class=\"qpo-buttons\">\n                <button type=\"submit\" id=\"qpo-submit\" class=\"qpo-button\">\n                    \ud83d\ude80 Envoyer la demande\n                <\/button>\n                <button type=\"button\" id=\"qpo-reset\" class=\"qpo-button qpo-button-reset\">\n                    \ud83d\udd04 Reset\n                <\/button>\n            <\/div>\n            <div id=\"qpo-alert\" class=\"qpo-alert\"><\/div>\n        <\/div>\n    <\/form>\n    <\/div>\n    \n    <div id=\"qpo-result\" class=\"qpo-result\">\n        <div class=\"qpo-result-content\">\n            <div id=\"qpo-type-box\" class=\"qpo-type-box\">\n                <div id=\"qpo-type-label\" class=\"qpo-type-label\">\ud83d\udccb DEMANDE ENVOY\u00c9E<\/div>\n                <div id=\"qpo-type-value\" class=\"qpo-type-value\"><\/div>\n            <\/div>\n            \n            <div class=\"qpo-notes-container\">\n                <div class=\"qpo-notes-header\">\n                    <h3 class=\"qpo-notes-title\">\ud83d\udccb D\u00e9tails envoy\u00e9s<\/h3>\n                    <button type=\"button\" id=\"qpo-copy\" class=\"qpo-copy-btn\">\ud83d\udccb Copier<\/button>\n                <\/div>\n                <pre id=\"qpo-notes\" class=\"qpo-notes\"><\/pre>\n            <\/div>\n            \n            <div class=\"qpo-result-actions\">\n                <button type=\"button\" id=\"qpo-new-demande\" class=\"qpo-new-demande-btn\">\n                    \ud83d\udd04 Nouvelle Demande\n                <\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n\n<script>\n(function() {\n    'use strict';\n    const $ = jQuery;\n    const config = {\n        ajaxUrl: '<?php echo $ajax_url; ?>',\n        nonce: '<?php echo $nonce; ?>'\n    };\n    \n    const $form = $('#qpo-form');\n    const $formContainer = $('.qpo-form-container');\n    const $result = $('#qpo-result');\n    const $notes = $('#qpo-notes');\n    const $typeValue = $('#qpo-type-value');\n    const $typeBox = $('#qpo-type-box');\n    const $typeLabel = $('#qpo-type-label');\n    const $alert = $('#qpo-alert');\n    const $submitBtn = $('#qpo-submit');\n    \n    \/\/ ============================================\n    \/\/ GESTION DU ZOOM - 70% PAR D\u00c9FAUT\n    \/\/ ============================================\n    const STORAGE_KEY = 'qualif_pneumo_ordonnances_zoom';\n    const minZoom = 0.5;\n    const maxZoom = 1.5;\n    const zoomStep = 0.1;\n    \n    let currentZoom;\n    \n    function getDefaultZoom() {\n        return 0.7;\n    }\n    \n    function loadZoom() {\n        const saved = localStorage.getItem(STORAGE_KEY);\n        if (saved) {\n            currentZoom = parseFloat(saved);\n            console.log('\ud83d\udcca Zoom charg\u00e9 depuis localStorage:', currentZoom);\n        } else {\n            currentZoom = getDefaultZoom();\n            console.log('\ud83d\udcca Zoom par d\u00e9faut \u00e0 70%:', currentZoom);\n        }\n        updateZoom(currentZoom, false);\n    }\n    \n    function saveZoom(zoom) {\n        localStorage.setItem(STORAGE_KEY, zoom);\n        console.log('\ud83d\udcbe Zoom sauvegard\u00e9:', zoom);\n    }\n    \n    function updateZoom(newZoom, save = true) {\n        if (newZoom < minZoom) newZoom = minZoom;\n        if (newZoom > maxZoom) newZoom = maxZoom;\n        currentZoom = newZoom;\n        $('.qpo-wrapper').css('zoom', currentZoom);\n        $('#qpo-zoom-display').text(Math.round(currentZoom * 100) + '%');\n        if (save) {\n            saveZoom(currentZoom);\n        }\n    }\n    \n    function resetZoom() {\n        const newDefault = getDefaultZoom();\n        updateZoom(newDefault);\n        console.log('\ud83d\udd04 Zoom r\u00e9initialis\u00e9 \u00e0 70%');\n    }\n    \n    $('#qpo-zoom-plus').on('click', function() {\n        updateZoom(currentZoom + zoomStep);\n    });\n    \n    $('#qpo-zoom-minus').on('click', function() {\n        updateZoom(currentZoom - zoomStep);\n    });\n    \n    $('#qpo-zoom-display').on('dblclick', function() {\n        resetZoom();\n    });\n    \n    $(document).on('keydown', function(e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (e.key === '+' || e.key === '=') {\n                e.preventDefault();\n                updateZoom(currentZoom + zoomStep);\n            } else if (e.key === '-' || e.key === '_') {\n                e.preventDefault();\n                updateZoom(currentZoom - zoomStep);\n            }\n        }\n    });\n    \n    loadZoom();\n    \n    \/\/ ============================================\n    \/\/ INTERACTIONS FORMULAIRE\n    \/\/ ============================================\n    \n    \/\/ Affichage message urgence pour secr\u00e9taires\n    $('input[name=\"type_demande\"]').on('change', function() {\n        const val = $(this).val();\n        \n        if (val === 'URGENCE') {\n            $('#urgence-warning').slideDown(200);\n        } else {\n            $('#urgence-warning').slideUp(200);\n        }\n    });\n    \n    \/\/ Style radio buttons\n    $('input[type=\"radio\"]').on('change', function() {\n        const name = $(this).attr('name');\n        $('input[name=\"' + name + '\"]').closest('.qpo-radio-item').removeClass('selected');\n        $(this).closest('.qpo-radio-item').addClass('selected');\n    });\n    \n    $('input[type=\"radio\"]:checked').each(function() {\n        $(this).closest('.qpo-radio-item').addClass('selected');\n    });\n    \n    const utils = {\n        showAlert: function(msg, type) {\n            $alert.removeClass('qpo-alert-success qpo-alert-error').addClass('qpo-alert-' + type).text(msg).fadeIn();\n            setTimeout(() => $alert.fadeOut(), 5000);\n        }\n    };\n    \n    \/\/ ============================================\n    \/\/ G\u00c9N\u00c9RATION NOTES\n    \/\/ ============================================\n    function generateNotes(data) {\n        let notes = '';\n        \n        \/\/ Si urgence, encadrer\n        if (data.type_demande === 'URGENCE') {\n            notes += '\ud83d\udea8 ========== URGENCE ========== \ud83d\udea8\\n\\n';\n        }\n        \n        notes += 'M\u00c9DECIN : ' + data.medecin + '\\n';\n        notes += 'TYPE : ' + data.type_demande + '\\n';\n        notes += 'MOTIF : ' + data.motif_demande + '\\n\\n';\n        notes += 'Date : ' + new Date().toLocaleString('fr-FR');\n        \n        if (data.type_demande === 'URGENCE') {\n            notes += '\\n\\n\ud83d\udea8 ========== URGENCE ========== \ud83d\udea8';\n        }\n        \n        return notes;\n    }\n    \n    \/\/ ============================================\n    \/\/ SOUMISSION FORMULAIRE\n    \/\/ ============================================\n    $form.on('submit', function(e) {\n        e.preventDefault();\n        if ($form.data('submitting')) return false;\n        $form.data('submitting', true);\n        \n        if (!this.checkValidity()) {\n            utils.showAlert('\u26a0\ufe0f Veuillez remplir tous les champs obligatoires', 'error');\n            $form.data('submitting', false);\n            return;\n        }\n        \n        $submitBtn.prop('disabled', true).text('\u23f3 Envoi en cours...');\n        \n        \/\/ Collecte donn\u00e9es\n        const formData = {\n            medecin: $('input[name=\"medecin\"]:checked').val(),\n            type_demande: $('input[name=\"type_demande\"]:checked').val(),\n            motif_demande: $('textarea[name=\"motif_demande\"]').val()\n        };\n        \n        \/\/ G\u00e9n\u00e9ration notes\n        const notesDoctolib = generateNotes(formData);\n        \n        \/\/ D\u00e9tection urgence\n        const isUrgence = (formData.type_demande === 'URGENCE');\n        \n        \/\/ Affichage r\u00e9sultat\n        $typeValue.text(formData.type_demande);\n        $notes.text(notesDoctolib);\n        \n        if (isUrgence) {\n            $typeBox.addClass('urgence');\n            $typeLabel.addClass('urgence-label').text('\ud83d\udea8 URGENCE ENVOY\u00c9E');\n            $typeValue.addClass('urgence-value');\n        } else {\n            $typeBox.removeClass('urgence');\n            $typeLabel.removeClass('urgence-label').text('\ud83d\udccb DEMANDE ENVOY\u00c9E');\n            $typeValue.removeClass('urgence-value');\n        }\n        \n        $formContainer.fadeOut(300, function() {\n            $result.fadeIn(400);\n            $('body').css('overflow', 'hidden');\n        });\n        \n        \/\/ Envoi AJAX\n        $.ajax({\n            url: config.ajaxUrl,\n            type: 'POST',\n            data: {\n                action: 'qpo_submit',\n                nonce: config.nonce,\n                website: $('input[name=\"website\"]').val(),\n                data: JSON.stringify({\n                    medecin: formData.medecin,\n                    type_demande: formData.type_demande,\n                    motif_demande: formData.motif_demande,\n                    notes_doctolib: notesDoctolib\n                })\n            },\n            success: function(response) {\n                if (response.success) {\n                    utils.showAlert('\u2705 ' + response.data.message, 'success');\n                } else {\n                    utils.showAlert('\u26a0\ufe0f ' + response.data.message, 'error');\n                }\n            },\n            error: function() {\n                utils.showAlert('\u26a0\ufe0f Erreur r\u00e9seau (notes affich\u00e9es)', 'error');\n            },\n            complete: function() {\n                $submitBtn.prop('disabled', false).text('\ud83d\ude80 Envoyer la demande');\n                $form.data('submitting', false);\n            }\n        });\n    });\n    \n    \/\/ ============================================\n    \/\/ BOUTONS RESET \/ NOUVELLE DEMANDE \/ COPIE\n    \/\/ ============================================\n    $('#qpo-reset').on('click', function() {\n        if (confirm('R\u00e9initialiser le formulaire ?')) {\n            $form[0].reset();\n            $result.fadeOut();\n            $formContainer.fadeIn();\n            $alert.hide();\n            $('#urgence-warning').hide();\n            $('.qpo-radio-item').removeClass('selected');\n            $('body').css('overflow', '');\n            $('html, body').animate({ scrollTop: 0 }, 500);\n            utils.showAlert('\u2705 Pr\u00eat pour nouvelle demande', 'success');\n        }\n    });\n    \n    $('#qpo-new-demande').on('click', function() {\n        $result.fadeOut(300, function() {\n            $form[0].reset();\n            $('.qpo-radio-item').removeClass('selected');\n            $('#urgence-warning').hide();\n            $alert.hide();\n            $formContainer.fadeIn(400);\n            $('body').css('overflow', '');\n            $('html, body').animate({ scrollTop: 0 }, 500);\n        });\n    });\n    \n    $('#qpo-copy').on('click', function() {\n        const text = $notes.text();\n        if (navigator.clipboard) {\n            navigator.clipboard.writeText(text).then(function() {\n                $('#qpo-copy').text('\u2713 Copi\u00e9 !');\n                setTimeout(function() { $('#qpo-copy').text('\ud83d\udccb Copier'); }, 2500);\n            });\n        } else {\n            alert('Copie automatique non support\u00e9e');\n        }\n    });\n})();\n<\/script>\n        <?php\n        return ob_get_clean();\n    }\n}\n\nadd_shortcode('qualif_pneumo_ordonnances', 'qpo_shortcode');","tags":["formulaire","qualif-pneumo"],"active":true,"modified":"2025-11-19 17:50:47","revision":"1"}]}